# SSL (TLS)

**Secure Sockets Layer**, now known as **Transport Layer Security** (TLS).

SSL was the original protocol used to encrypt network communications, but it has been replaced by TLS due to security vulnerabilities. Despite this, the term "SSL" is still widely used to refer to encrypted communication in general.

## Certificates

An **SSL certificate** is a digital certificate issued by a **Certificate Authority (CA)** to verify the identity of a server and enable HTTPS encryption. SSL certificates protect communications between clients and servers by encrypting data, ensuring that it is not intercepted or tampered with during transmission.

### An SSL certificate contains:

1. **Public key**: Used to encrypt data. The client encrypts information with the public key, and only the server with the private key can decrypt it.
2. **Server information**: Includes the domain name, organization details, and other identifying information.
3. **Certificate Authority signature**: A digital signature from a trusted CA that validates the authenticity of the certificate.

### Certificate types:

1. **Self-signed certificate**:

- Generated by yourself, typically used for local development.
- Not trusted by browsers or operating systems, so you'll see security warnings in the browser when using these certificates.

2. **Formal certificate**:

- Issued by a trusted **Certificate Authority (CA)** like Let's Encrypt, DigiCert, or GlobalSign.
- Used in production environments to ensure secure communication between users and servers.
- Recognized by browsers and operating systems as valid and trusted.

## Create SSL Certificates

### OpenSSL

You can generate a self-signed certificate using **OpenSSL**. OpenSSL is a powerful tool that helps in generating cryptographic keys and managing SSL certificates.

#### Steps to generate a self-signed certificate:

1. Check the OpenSSL version:

```bash
openssl version
```

2. Generate a self-signed certificate using OpenSSL:

```bash
openssl req -x509 -newkey rsa:2048 -keyout private-key.pem -out certificate.pem -days 365 -nodes
```

This command will generate two files:

- private-key.pem: The private key, used to decrypt data on the server side.
- certificate.pem: The self-signed SSL certificate, used to encrypt data on the client side.

You can use these files to set up HTTPS in local development environments.

### Mkcert

[Mkcert](https://github.com/FiloSottile/mkcert) is a simple tool for making locally-trusted development certificates. It requires no configuration and automates much of the process.

```bash
$ mkcert -install
Created a new local CA
The local CA is now installed in the system trust store!
The local CA is now installed in the Firefox trust store (requires browser restart)!

$ mkcert example.com "*.example.com" example.test localhost 127.0.0.1 ::1

Created a new certificate valid for the following names
 - "example.com"
 - "*.example.com"
 - "example.test"
 - "localhost"
 - "127.0.0.1"
 - "::1"

The certificate is at "./example.com+5.pem" and the key at "./example.com+5-key.pem"
```

#### Why use mkcert?

Self-signed certificates typically cause trust errors in browsers, but mkcert creates a local CA and installs it in your system's root trust store, making it easy to generate certificates that are trusted locally. However, mkcert does not configure your server to use these certificates, so you will need to configure your local server manually.

### Let's Encrypt

For production environments, Let's Encrypt is a widely used and free service that provides SSL certificates automatically.

**Steps to apply for certificates using Certbot:**

1. Install Certbot (for CentOS 7, as an example):

```bash
sudo yum install certbot python2-certbot-nginx -y
```

2. Apply for a certificate:

```bash
sudo certbot --nginx
```

Certbot will automatically detect your Nginx configuration and guide you through the process of obtaining a valid SSL certificate for your domain.

3. Setup automatic renewal: Certbot automatically installs a timer to check and renew your certificates before they expire. You can check the status of this timer:

```bash
sudo systemctl status certbot.timer
```

4. Manual renewal (optional): To manually test certificate renewal, you can run:

```bash
sudo certbot renew --dry-run
```

**Benefits of Let's Encrypt:**

- Free and Automated: Let's Encrypt certificates are free and automatically renewed before they expire.
- Secure: Certificates issued by Let's Encrypt are widely trusted by browsers and operating systems, ensuring secure communications in production environments.
